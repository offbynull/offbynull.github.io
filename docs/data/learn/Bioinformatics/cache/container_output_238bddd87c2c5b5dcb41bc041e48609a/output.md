<div style="margin:2em; background-color: #e0e0e0;">

<strong>⚠️NOTE️️️⚠️</strong>

To keep things efficient-ish, the code below actually splits out `first_indexes` into a dictionary. Otherwise, you end up with a bunch of `None` entries under `first_indexes` and that actually ends up taking space.
</div>

